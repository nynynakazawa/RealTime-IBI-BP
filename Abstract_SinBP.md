Skew+sin 非対称波形モデル残差に基づく血圧推定
中澤 祐介

要旨

スマートフォン可視カメラ由来の擬似PPGに対し、周波数分解に依存しない「最小モデル残差」による血圧推定を提案する。1拍波形をSkew+sin 非対称モデル＋平均で近似し、残差RMSを歪み指標 E として定式化、さらに E√A（Stiffness_sin） により血管硬さを定量化する。Skew+sinはベータ様非対称基底（a=2.6, b=5.2）で速い立ち上がり＋長い下降尾を表現し、微小サイン項（ρ=0.25, ψ=π/2）で下降相の“ふくらみ”を付与する。階層三段推定（A・HR → relTTP・Stiffness_sin → E）により、30fpsという低FPS・高ノイズ条件での安定性を狙う。
本論文は同一データでの厳密な対照実験計画を含むRegistered-Report（Stage-1）形式で提示し、再現可能な前登録済み解析計画として公開する。

⸻

1. 序論

連続的な非侵襲血圧モニタリングの需要は高いが、スマートフォン可視カメラのPPGは低SNR・30fpsという制約が大きい。従来の高調波比・THD・A₂/A₁等の周波数分解前提手法は、位相ゆらぎや照明変動に弱い。本研究は生理的に妥当な非対称一峰波形を基準とし、**基準からの外れ（最小モデル残差）**を一次特徴化することで、低FPS条件での堅牢な推定を目指す。

貢献
	1.	Skew+sin 非対称基準波形の定義と、E・E√Aに基づく推定枠組み。
	2.	IBI同期（拍ごとにT=IBI）かつピーク=0,T整列による比較可能な正規化。
	3.	同一データ・同一前処理での対照実験計画（ベースライン群・アブレーション・統計計画）。
	4.	30fps/可視カメラ前提の再現性重視プロトコル（交差検証・前登録・コード/閾値固定方針）。

⸻

2. 手法

2.1 Skew+sin 非対称モデルと残差

モデル定義
\[
\begin{aligned}
& s(t)=\mathrm{mean}+A\,s_{\mathrm{norm}}(t),\\
& s_{\mathrm{norm}}(t)=(1-\rho)\,z^\(t)+\rho\,u(t),\\
& z^\(t)=\frac{x^{a-1}(1-x)^{b-1}}{x_{\mathrm{mode}}^{a-1}(1-x_{\mathrm{mode}})^{b-1}},\quad
x(t)=\Bigl(\frac{t}{T}+x_{\mathrm{mode}}\Bigr)\bmod1,\\
& x_{\mathrm{mode}}=\frac{a-1}{a+b-2},\quad u(t)=\frac{1+\sin(2\pi t/T+\psi)}{2}.
\end{aligned}
\]
既定：a=2.6,\ b=5.2,\ \rho=0.25,\ \psi=\pi/2。Tは実測IBI（ms）。数値安定化のため x\in[\varepsilon,1-\varepsilon]（\varepsilon\!\approx\!10^{-12}）にクリップ。t=0, Tでピーク整合。

残差（歪み）E
1拍（N点）に対し、E=\sqrt{\frac{1}{N}\sum_{n}(x[n]-s[n])^2}。
Stiffness_sin は E\sqrt{A}。階層三段（A・HR → relTTP・Stiffness_sin → E）で推定量を構成。

2.2 前処理と正規化
	•	ピーク検出：移動窓最大＋不応期≥500 ms。
	•	ビート切り出し：現在ピーク→次ピークを1拍。T=IBI。
	•	時間正規化：各拍を固定長（例：N=64）へリサンプリング。
	•	ピーク整列：全手法でt=0,Tがピークとなるよう整列。
	•	外れ値抑制：IBI・振幅・テンポラルジャンプに基づくハンペル/ルールベース除外。

⸻

3. 実験計画（前登録・対照条件）

3.1 データ取得（これから実施）
	•	環境：スマートフォン可視カメラ（30fps）、指腹接触方式。照明（室内/屋外/点滅）、指圧、スキントーンを層別化。
	•	参照：上腕カフ（臨床グレード）で同時計測（測定間隔・体位・安静時間を統一）。
	•	対象：年齢/性別/スキントーンが偏らないよう募集（除外：不整脈重度等）。
	•	倫理：同意取得・匿名化・暗号化保存。

3.2 同一データ・同一前処理の対照実験

全手法が同じ拍列・同じ正規化系列を入力する前提で比較。学習/検証の分割は完全共通。
ベースライン（すべてIBI同期・ピーク整列・同一特徴抽出窓）
	•	形態学派：AI、TTP、HR、S/D、勾配、二次微分指標（RealtimeBP系）。
	•	高調波派：A₂/A₁、THD（最小限の調和数、30fps適合設定）。
	•	DCT派：低次DCT係数＋Ridge/Lasso。
	•	小調和合成：\sin(2\pi t/T)+\alpha\sin(4\pi t/T+\psi)。
	•	学習基準：上記特徴→線形/リッジ。ハイパラは前登録し、検証データでの探索は禁止。

アブレーション
	•	(i) A・HR のみ
	•	(ii) + relTTP
	•	(iii) + Stiffness_sin
	•	(iv) + E（最終）
各段での寄与を定量化。ρ=0, ψ固定なども検証してSkew骨格の純度を評価。

3.3 検証設計・統計計画
	•	分割：被験者独立のLOSO（Leave-One-Subject-Out）。サブ解析としてK-fold（被験者分割）。
	•	主要指標：SBP/DBP MAE, MD±SD, Bland–Altman, CCC。
	•	基準：AAMI（|MD|≤5 mmHg かつ SD≤8 mmHg）とBHS（≤5/10/15 mmHg の累積比率）を報告。
	•	検定：提案法 vs 各ベースラインの二者比較（対応あり）。MD差の95% CI、ブートストラップで頑健CI。
	•	事前仮説：
H1 提案法は30fps条件において形態/高調波/DCT基準よりMAEが小さい。
H2 Stiffness_sin はAIと独立寄与を持つ（重回帰の部分相関/分散説明率）。
H3 ノイズ・照度・スキントーン層で性能低下が小さい（交互作用が小）。
	•	多重性：Holm法で補正。
	•	リーク防止：スケール/正規化/閾値は訓練内のみで決定、検証には適用のみ。同一被験者の交差漏れを禁止。

⸻

4. ロバスト性試験
	•	ノイズ耐性：ホワイト/低周波ドリフト/照度ゆらぎの合成撹乱。
	•	FPS依存：30fps → 24/20fpsサブサンプリングで劣化曲線。
	•	モーション：微小動揺の再現（微分エネルギー閾値）。
	•	皮膚特性：スキントーン層別のMAE/MD±SD報告。

⸻

5. 再現性・公開方針
	•	前登録：分割、ハイパラ、除外規則、主要/副次評価項目を固定。
	•	コード：前処理・特徴抽出・学習・統計の完全スクリプト化（乱数種固定）。
	•	成果物：解析ログ、分割リスト、推定値CSV、Bland–Altmanプロットを一括保存。

⸻

6. 期待される結果と意義（解釈枠組み）
	•	30fps環境での優位：周波数分解に頼らず、Skew骨格＋最小モデル残差で安定。
	•	物理解釈性：Eは“生理整合的な基準”からの逸脱量、E√Aは拡張能×歪みの合成指標。
	•	実装容易性：少数パラメータ・閉形式スケール推定・軽量でオンデバイス適合。

⸻

7. 限界とリスク低減
	•	単一基準形の限界：個体差・切痕の強い症例では二成分化/局所バンプで拡張。
	•	撮像依存性：条件別バイアスは個体内標準化・層別補正で緩和。
	•	一般化：被験者外検証と外部データ再現で担保。

⸻

8. 結論

本研究は、可視カメラ×30fpsの制約下で機能するSkew+sin非対称基準＋最小モデル残差による血圧推定を、厳密な対照実験計画とともに提示した。同一データ・同一前処理・同一分割でベースラインと正面比較し、E・E√A・relTTPの段階的寄与を検証する。結果の提出（Stage-2）に向け、当該プロトコルに従ってデータ収集・解析を実施する。

⸻

付録（実装メモ：数式のみ）
	•	初期値：a=2.6,\ b=5.2,\ \rho=0.25,\ \psi=\pi/2。
	•	1:2寄せの初期化：b\approx 2a-1（厳密比は最適化で微調整）。
	•	Eの安定化：N=64固定、外れ拍除外、中央値/MADでロバスト平均。
	•	評価閾値：AAMI（|MD|≤5, SD≤8）、BHS（≤5/10/15 mmHg の累積比率）。