可視カメラ 30fps 環境の PPG に最適化した
非対称サイン波モデル残差に基づく血圧推定
中澤 祐介

要旨

スマートフォン可視カメラ由来の擬似PPGに対し、周波数分解に依存しない「最小モデル残差」による血圧推定（SinBP）を提案する。1拍波形を「生理学的非対称サイン波モデル」＋平均で近似し、残差RMSを歪み指標Eとして定式化、さらにE√A（Stiffness_sin）により血管硬さを定量化する。非対称サイン波モデルは「ピーク→谷が周期の2/3、谷→次ピークが1/3」となる位相写像で構成し、各拍のIBIに同期させ、データ駆動の位相探索により理想波のピークを実測ピークに整合させる。階層三段推定（A・HR → relTTP（谷→山・山→谷）・Stiffness_sin → E）で、30fpsという低FPS・高ノイズ条件でも安定化を図る。
本研究は同一データでの厳密な対照実験計画を含むRegistered-Report（Stage-1）形式で提示し、再現可能な前登録済み解析計画として公開する。

⸻

1. 序論

連続的な非侵襲血圧モニタリングの需要は高いが、スマートフォン可視カメラのPPGは低SNR・30fpsという制約が大きい。従来の高調波比・THD・A₂/A₁等の周波数分解前提手法は、位相ゆらぎや照明変動に弱い。本研究は生理的に妥当な非対称一峰波形を基準とし、基準からの外れ（最小モデル残差）を一次特徴化することで、低FPS条件での堅牢な推定を目指す。

貢献
	1.	非対称サイン波基準の定義と、E・E√A（Stiffness_sin）に基づく推定枠組み。
	2.	IBI同期（拍ごとにT=IBI）かつピーク整合（位相探索）による比較可能な正規化。
	3.	同一データ・同一前処理での対照実験計画（ベースライン群・アブレーション・統計計画）。
	4.	30fps/可視カメラ前提の再現性重視プロトコル（交差検証・前登録・コード/閾値固定方針）。

⸻

2. 手法

2.1 非対称サイン波モデルと残差

モデル定義（実装準拠）
[数式]
 s(t) = mean + A · s_norm(t)
 s_norm(t) = (1 + cos(θ(t) + φ0)) / 2
 θ(t) = { (3π/2) · (t'/T)            (0 ≤ t' ≤ 2T/3)
          π + 3π · ((t' − 2T/3)/T)   (2T/3 < t' ≤ T) }
 ここで、t' = (t − τ*) mod T は1拍内の位相時間、φ0は小さな位相シフト（実装で調整可）、τ*は各拍ごとに「s_norm(t)のピークが実測ピークと一致するように」T内で探索して決定する（ピーク合致の位相探索）。

残差（歪み）E
 1拍（N点）に対し、E = sqrt( (1/N) · Σ_n (x[n] − s[n])^2 )。
 Stiffness_sin は E√A。階層三段（A・HR → relTTP（谷→山・山→谷）・Stiffness_sin → E）で推定量を構成し、従来のAIはSinBPでは用いずStiffness_sinを優先する。

2.2 前処理と正規化
	•	ピーク検出：移動窓最大＋不応期≥500 ms。
	•	ビート切り出し：現在ピーク→次ピークを1拍。T=IBI。
	•	時間正規化：各拍を固定長（例：N=64）へリサンプリング。
	•	ピーク整合：各拍でτ*（位相探索）により理想波ピークを実測ピークに一致させる。
	•	外れ値抑制：IBI・振幅・テンポラルジャンプに基づくハンペル/ルールベース除外。

⸻

3. 実験計画（前登録・対照条件）

3.1 データ取得（これから実施）
	•	環境：スマートフォン可視カメラ（30fps）、指腹接触方式。照明（室内/屋外/点滅）、指圧、スキントーンを層別化。
	•	参照：上腕カフ（臨床グレード）で同時計測（測定間隔・体位・安静時間を統一）。
	•	対象：年齢/性別/スキントーンが偏らないよう募集（除外：不整脈重度等）。
	•	倫理：同意取得・匿名化・暗号化保存。

3.2 同一データ・同一前処理の対照実験

全手法が同じ拍列・同じ正規化系列を入力する前提で比較。学習/検証の分割は完全共通。
ベースライン（すべてIBI同期・ピーク整合・同一特徴抽出窓）
	•	形態学派：TTP（relTTP：谷→山・山→谷）、HR、S/D、勾配、二次微分指標（RealtimeBP系）。
	•	高調波派：A₂/A₁、THD（最小限の調和数、30fps適合設定）。
	•	DCT派：低次DCT係数＋Ridge/Lasso。
	•	小調和合成：sin(2πt/T)+α·sin(4πt/T+ψ)。
	•	学習基準：上記特徴→線形/リッジ。ハイパラは前登録し、検証データでの探索は禁止。

アブレーション
	•	(i) A・HR のみ
	•	(ii) + relTTP（谷→山・山→谷の両方向）
	•	(iii) + Stiffness_sin（E√A）
	•	(iv) + E（最終）
 各段での寄与を定量化。

3.3 検証設計・統計計画
	•	分割：被験者独立のLOSO（Leave-One-Subject-Out）。サブ解析としてK-fold（被験者分割）。
	•	主要指標：SBP/DBP MAE, MD±SD, Bland–Altman, CCC。
	•	基準：AAMI（|MD|≤5 mmHg かつ SD≤8 mmHg）とBHS（≤5/10/15 mmHg の累積比率）。
	•	検定：提案法 vs 各ベースラインの二者比較（対応あり）。MD差の95% CI、ブートストラップで頑健CI。
	•	事前仮説：
 H1 提案法は30fps条件において形態/高調波/DCT基準よりMAEが小さい。
 H2 Stiffness_sin は従来AIと独立寄与を持つ（重回帰の部分相関/分散説明率）。
 H3 ノイズ・照度・スキントーン層で性能低下が小さい（交互作用が小）。
	•	多重性：Holm法で補正。
	•	リーク防止：スケール/正規化/閾値は訓練内のみで決定、検証には適用のみ。同一被験者の交差漏れを禁止。

⸻

4. ロバスト性試験
	•	ノイズ耐性：ホワイト/低周波ドリフト/照度ゆらぎの合成撹乱。
	•	FPS依存：30fps → 24/20fpsサブサンプリングで劣化曲線。
	•	モーション：微小動揺の再現（微分エネルギー閾値）。
	•	皮膚特性：スキントーン層別のMAE/MD±SD報告。

⸻

5. 再現性・公開方針
	•	前登録：分割、ハイパラ、除外規則、主要/副次評価項目を固定。
	•	コード：前処理・特徴抽出・学習・統計の完全スクリプト化（乱数種固定）。
	•	成果物：解析ログ、分割リスト、推定値CSV、Bland–Altmanプロットを一括保存。

⸻

6. 期待される結果と意義（解釈枠組み）
	•	30fps環境での優位：周波数分解に頼らず、非対称サイン骨格＋最小モデル残差で安定。
	•	物理解釈性：Eは“生理整合的な基準”からの逸脱量、E√A（Stiffness_sin）は拡張能×歪みの合成指標。
	•	実装容易性：少数パラメータ・軽量でオンデバイス適合。位相はデータ駆動で自動整合。

⸻

7. 限界とリスク低減
	•	単一基準形の限界：個体差・切痕の強い症例では二成分化/局所バンプで拡張。
	•	撮像依存性：条件別バイアスは個体内標準化・層別補正で緩和。
	•	一般化：被験者外検証と外部データ再現で担保。

⸻

8. 結論

本研究は、可視カメラ×30fpsの制約下で機能する「非対称サイン波基準＋最小モデル残差」による血圧推定（SinBP）を、厳密な対照実験計画とともに提示した。同一データ・同一前処理・同一分割でベースラインと正面比較し、E・E√A・relTTPの段階的寄与を検証する。実装では各拍のIBI同期、ピーク合致の位相探索、そして表示上は振幅の視覚強調（中心から1.5倍拡大）を行い、同期性と視認性を両立した。

⸻

付録（実装メモ：要点）
	•	理想波：非対称サイン基底（ピーク→谷=2/3T、谷→ピーク=1/3T）、小位相シフトφ0は調整可。
	•	位相整合：各拍でT内のピークを最大探索し実測ピークと一致させる（τ*）。
	•	E計算：N=64固定、外れ拍除外、中央値/MADでロバスト平均。
	•	表示：視認性のため理想波の中心偏差を1.5倍拡大（推定計算のEには影響なし）。
	•	評価閾値：AAMI（|MD|≤5, SD≤8）、BHS（≤5/10/15 mmHg の累積比率）。